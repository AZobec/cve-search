<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Common Vulnerability Exposure most recent entries</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Common Vulnerability Exposure most recent entries">
  <meta name="author" content="http://github.com/adulau/cve-search - cve-search">
  <meta name="author" content="http://github.com/pidgeyl/cve-search - cve-search">

  <!--link rel="stylesheet/less" href="less/bootstrap.less" type="text/css" /-->
  <!--link rel="stylesheet/less" href="less/responsive.less" type="text/css" /-->
  <!--script src="js/less-1.3.3.min.js"></script-->
  <!--append ‘#!watch’ to the browser URL, then refresh the page. -->
  <link href="/static/css/bootstrap.min.css" rel="stylesheet">
  <link href="/static/css/bootstrap-responsive.min.css" rel="stylesheet">
  <link href="/static/css/style.css" rel="stylesheet">

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/img/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/static/img/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/static/img/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/static/img/apple-touch-icon-57-precomposed.png">
  <link rel="shortcut icon" href="/static/img/favicon.png">
  <script type="text/javascript" src="/static/js/jquery.min.js"></script>
  <script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/static/js/scripts.js"></script>

  <script type="text/javascript">
      $(function () {
          $("[rel='tooltip']").tooltip();
      });
  </script>
  <script>
    function redirect() {
      var url = "/cve/" + document.getElementById("search").value.toUpperCase(); window.location = url;
    }
    function listURLBuilder(url, list){
      var file = document.getElementById(list+"_Import").value.trim();
      var force = "";
      if (file != ""){
        if (document.getElementById(list+"_ForceImport").checked == true){
          force = "f";
        }else{
          force = "df";
        }
        file = btoa(file)
        url = url + force + "/" + file;
        window.location = url;
      }else{
        alert('Please select a file');
      }
    }
    function whitelistImport(){
      listURLBuilder("/admin/whitelist/import/", 'wl');
    }
    function whitelistExport(){
      listURLBuilder("/admin/whitelist/export/", 'wl');
    }
    function dropWhitelist(){
      if(confirm("You are about to drop the whitelist. Are you sure?")){
        var url = "/admin/whitelist/drop";window.location = url;
      }
    }
    function blacklistImport(){ 
      listURLBuilder("/admin/blacklist/import/", 'bl');
    }
    function blacklistExport(){
      listURLBuilder("/admin/blacklist/export/", 'bl');
    }
    function dropBlacklist(){
      if(confirm("You are about to drop the whitelist. Are you sure?")){
        var url = "/admin/blacklist/drop";window.location = url;
      }
    }
  </script>
</head>

<body>
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span12">
      <!-- Nav -->
      <div class="navbar">
        <div class="navbar-inner">
          <a class="brand" href="/">cve-search</a>
          <ul class="nav">
            <li><a href="/">Recent</a></li>
            <li><a href="/browse">Browse per vendor</a></li>
            <li><a href="/whitelist">Whitelisted search</a></li>
          </ul>
          <form id="tfnewsearch" method="get" class="nav form-search" onsubmit="redirect(); return false;">
            <input type="text" id="search" size="15" pattern="[cC][vV][eE]-[0-9]{4}-[0-9]{4,6}" >
            <input type="submit" value="search" class="tfbutton">
          </form>
          <div id="admin">
            <a href="/admin">Admin</a>
          </div>
        </div>
      </div>
      <!-- End Nav -->
      <!-- Content -->
      <div>
        <!-- Status -->
        <div>
          <!-- type -->
          {% if status[1] == 'success' %}
            <div class='alert alert-success'>
              <i class="glyphicon icon-ok-sign"></i>
          {% elif status[1] == 'info' %}
            <div class='alert alert-info'>
              <i class="glyphicon icon-info-sign"></i>
          {% elif status[1] == 'error' %}
            <div class='alert alert-error'>
              <i class="glyphicon icon-remove-sign"></i>
          {% else %}
            <div>
          {% endif %}
            <!-- content -->
            {% if status[0].startswith('wl_') %}
               {% set list = 'Whitelist' %}
            {% elif status[0].startswith('bl_') %}
               {% set list = 'Blacklist' %}
            {% endif %}

            {% if status[0] == 'db_updated' %}
              Database update finished
            {% elif (status[0] == 'wl_imported') or (status[0] == 'bl_imported') %}
              {{ list }} import finished
            {% elif (status[0] == 'wl_already_filled') or (status[0] == 'bl_already_filled') %}
              {{ list }} is already filled. You can force to drop the database
            {% elif (status[0] == 'wl_exported') or (status[0] == 'bl_exported') %}
              {{ list }} export finished
            {% elif (status[0] == 'wl_file_already_exists') or (status[0] == 'bl_file_already_exists') %}
              A file with that name already exists. The {{ list|lower }} was not exported
            {% elif (status[0] == 'wl_dropped') or (status[0] == 'bl_dropped') %}
              {{ list }} dropped
            {% elif status[0] == 'invalid_path_format' %}
              Invalid path format!
            {% elif status[0] == 'invalid_path' %}
              Invalid path!
            {% endif %}
            </div>
        </div>
        <!-- Warning note -->
        <div class='alert alert-block'>
          <i class="glyphicon icon-warning-sign"></i>
          Always verify the result of your administrative tasks in the console!
        </div>
        <!-- Database update -->
        <div class="well well-small">
          <form action="/admin/updatedb">
            <strong>Update the database</strong> <br />
            <input type="submit" value="Update"/>
          </form>
        </div>
        <!-- Whitelist import -->
        <div class="well well-small">
          <strong>Import whitelist file</strong> <br />
          <input id="wl_Import" type='text' placeholder="full path to file" pattern="[a-z0-9/ ._-]+" /> <br />
          <input type="checkbox" id="wl_ForceImport">Force import <br />
          <button onclick="whitelistImport()">Import</button>
          <button onclick="whitelistExport()">Export</button>
          <button onclick="dropWhitelist()">Drop list</button>
        </div>
        <!-- Blacklist import -->
        <div class="well well-small">
          <strong>Import blacklist file</strong> <br />
          <input id="bl_Import" type='text' placeholder="full path to file" pattern="[a-z0-9/ ._-]+" /> <br />
          <input type="checkbox" id="bl_ForceImport">Force import <br />
          <button onclick="blacklistImport()">Import</button>
          <button onclick="blacklistExport()">Export</button>
          <button onclick="dropBlacklist()">Drop list</button>
        </div>
      </div>
      <!-- end content -->
    </div>
  </div>
</div>
</body>
