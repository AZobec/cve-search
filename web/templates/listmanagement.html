<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Admin page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Common Vulnerability Exposure most recent entries">
  <meta name="author" content="http://github.com/adulau/cve-search - cve-search">
  <meta name="author" content="http://github.com/pidgeyl/cve-search - cve-search">

  <!--link rel="stylesheet/less" href="less/bootstrap.less" type="text/css" /-->
  <!--link rel="stylesheet/less" href="less/responsive.less" type="text/css" /-->
  <!--script src="js/less-1.3.3.min.js"></script-->
  <!--append ‘#!watch’ to the browser URL, then refresh the page. -->
  <link href="/static/css/bootstrap.min.css" rel="stylesheet">
  <link href="/static/css/bootstrap-responsive.min.css" rel="stylesheet">
  <link href="/static/css/style.css" rel="stylesheet">

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/img/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/static/img/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/static/img/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/static/img/apple-touch-icon-57-precomposed.png">
  <link rel="shortcut icon" href="/static/img/favicon.png">
  <script type="text/javascript" src="/static/js/jquery.min.js"></script>
  <script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/static/js/scripts.js"></script>

  <script type="text/javascript">
      $(function () {
          $("[rel='tooltip']").tooltip();
      });
  </script>
  <script>
    function redirect() {
      var url = "/cve/" + document.getElementById("search").value.toUpperCase(); window.location = url;
    }
    function addCPE(list, item){
      var url = "/admin/listmanagement/add/"+list+"/"+btoa(item);
      window.location = url;
    }
  </script>
</head>

<body>
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span12">
      <!-- Nav -->
      <div class="navbar">
        <div class="navbar-inner">
          <a class="brand" href="/">cve-search</a>
          <ul class="nav">
            <li><a href="/">Recent</a></li>
            <li><a href="/browse">Browse per vendor</a></li>
            <li><a href="/whitelist">Whitelisted search</a></li>
          </ul>
          <form id="tfnewsearch" method="get" class="nav form-search" onsubmit="redirect(); return false;">
            <input type="text" id="search" size="15" pattern="[cC][vV][eE]-[0-9]{4}-[0-9]{4,6}" >
            <input type="submit" value="search" class="tfbutton">
          </form>
          <div id="admin">
            <a href="/admin">Admin</a>
          </div>
        </div>
      </div>
      <!-- End Nav -->
      <!-- Content -->
      <div>
        <!-- Status -->
        <div>
          <!-- type -->
          {% if status[1] == 'success' %}
            <div class='alert alert-success'>
              <i class="glyphicon icon-ok-sign"></i>
          {% elif status[1] == 'info' %}
            <div class='alert alert-info'>
              <i class="glyphicon icon-info-sign"></i>
          {% elif status[1] == 'error' %}
            <div class='alert alert-error'>
              <i class="glyphicon icon-remove-sign"></i>
          {% else %}
            <div>
          {% endif %}
            <!-- content -->
            {% if (status[0] == 'cpe_added') %}
              Product added to the {{ listType }}
            {% elif status[0] == 'cpe_not_added' %}
              Failed to add the product to the {{ listType }}
            {% elif (status[0] == 'invalid_cpe_format') %}
              The entered CPE format is invalid
            {% endif %}
            </div>
        </div>
        <!-- back -->
        <div>
          {% if version != None%}
            <a href="/admin/listmanagement/{{vendor}}">Back to <strong>{{ vendor }}</strong></a>
          {% elif product != None %}
            <a href="/admin/listmanagement">Back to <strong>vendors</strong></a>
          {% elif product == None %}
            <a href="/admin">Back to <strong>Admin panel</strong></a>
          {% endif %}
        </div>
        <!-- vendor/product/version -->
        <table class="table table-hover table-striped">
          <tbody>
            <tr>
              <td class="warning">
                {% if version != None%}
                  Versions for {{ vendor }} {{ product }}
                {% elif product != None %}
                  Products for {{ vendor }}
                {% elif product == None %}
                  Vendors
                {% endif %}
              </td>
            </tr>
            {% if version != None %}
              {% for v in version %}
                <tr>
                  <td>{{ product }} {{ v.decode(encoding='UTF-8') }}</td>
                  <td><a href="javascript:addCPE('whitelist','{{vendor}}:{{ product }}:{{ v.decode(encoding='UTF-8') }}')";"><i class="glyphicon icon-eye-open"></i> whitelist</a></td>
                  <td><a href="javascript:addCPE('blacklist','{{vendor}}:{{ product }}:{{ v.decode(encoding='UTF-8') }}')";"><i class="glyphicon icon-eye-close"></i> blacklist</a></td> 
                </tr>
              {% endfor %}
            {% elif product != None %}
              {% for p in product %}
                <tr>
                  <td><a href="/admin/listmanagement/{{ vendor }}/{{ p.decode(encoding='UTF-8') }}">{{ p.decode(encoding='UTF-8') }}</a> </td>
                  <td><a href="javascript:addCPE('whitelist','{{vendor}}:{{ p.decode(encoding='UTF-8') }}')";"><i class="glyphicon icon-eye-open"></i> whitelist</a></td>
                  <td><a href="javascript:addCPE('blacklist','{{vendor}}:{{ p.decode(encoding='UTF-8') }}')";"><i class="glyphicon icon-eye-close"></i> blacklist</a></td>
                </tr>
              {% endfor %}
            {% else  %}
              {% for v in vendor %}
                <tr>
                  <td><a href="/admin/listmanagement/{{ v.decode(encoding='UTF-8') }}">{{ v.decode(encoding='UTF-8') }}</a></td>
                  <td><a href="javascript:addCPE('whitelist','{{ v.decode(encoding='UTF-8') }}')";"><i class="glyphicon icon-eye-open"></i> whitelist</a></td>
                  <td><a href="javascript:addCPE('blacklist','{{ v.decode(encoding='UTF-8') }}')";"><i class="glyphicon icon-eye-close"></i> blacklist</a></td>
                </tr>
              {% endfor %}
            {% endif %}
          </tbody>
        </table>
      </div>
      <!-- end content -->
    </div>
  </div>
</div>
</body>
