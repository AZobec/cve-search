<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Common Vulnerability Exposure most recent entries</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Common Vulnerability Exposure most recent entries">
  <meta name="author" content="http://github.com/adulau/cve-search - cve-search">
  <meta name="author" content="http://github.com/pidgeyl/cve-search - cve-search">

  <!--link rel="stylesheet/less" href="less/bootstrap.less" type="text/css" /-->
  <!--link rel="stylesheet/less" href="less/responsive.less" type="text/css" /-->
  <!--script src="js/less-1.3.3.min.js"></script-->
  <!--append ‘#!watch’ to the browser URL, then refresh the page. -->
  <link href="/static/css/bootstrap.min.css" rel="stylesheet">
  <link href="/static/css/bootstrap-responsive.min.css" rel="stylesheet">
  <link href="/static/css/style.css" rel="stylesheet">

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/img/apple-touch-icon-144-precomposed.png
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/static/img/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/static/img/apple-touch-icon-57-precomposed.png">
  <link rel="shortcut icon" href="/static/img/favicon.png">
  <script type="text/javascript" src="/static/js/jquery.min.js"></script>
  <script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/static/js/scripts.js"></script>

  <script type="text/javascript">
      $(function () {
          $("[rel='tooltip']").tooltip();
      });
  </script>
  <script>
    function redirect() {
      var url = "/cve/" + document.getElementById("search").value.toUpperCase();
      window.location = url;
    }
    function addItem() {
      var CPE = document.getElementById("id").value.trim();
      var commentArray = document.getElementById("comments").value.trim()
      var comments = ""
      if (commentArray){
        commentArray = commentArray.split("\n");
        for (comment in commentArray){
          comments = comments + "# " + commentArray[comment];
        }
      }
      CPE = CPE+comments;
      CPE = btoa(CPE);
      var url ="/admin/whitelist/add/" + CPE;
      
      window.location = url;
    }
  </script>
</head>

<body>
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span12">
      <!-- Nav -->
      <div class="navbar">
        <div class="navbar-inner">
          <a class="brand" href="/">cve-search</a>
          <ul class="nav">
            <li><a href="/">Recent</a></li>
            <li><a href="/browse">Browse per vendor</a></li>
            <li><a href="/whitelist">Whitelisted search</a></li>
          </ul>
          <form id="tfnewsearch" method="get" class="nav form-search" onsubmit="redirect(); return false;">
            <input type="text" id="search" size="15" pattern="[cC][vV][eE]-[0-9]{4}-[0-9]{4,6}" >
            <input type="submit" value="search" class="tfbutton">
          </form>
          <div id="admin">
            <a href="/admin">Admin</a>
          </div>
        </div>
      </div>
      <!-- End Nav -->
      <!-- Content -->
      <div>
        <!-- Status -->
        <div>
          <!-- type -->
          {% if status[1] == 'success' %}
            <div class='alert alert-success'>
              <i class="glyphicon icon-ok-sign"></i>
          {% elif status[1] == 'info' %}
            <div class='alert alert-info'>
              <i class="glyphicon icon-info-sign"></i>
          {% elif status[1] == 'error' %}
            <div class='alert alert-error'>
              <i class="glyphicon icon-remove-sign"></i>
          {% else %}
            <div>
          {% endif %}
            <!-- content -->
            {% if status[0] == 'added' %}
              Rule added to the {{ listType }}
            {% elif (status[0] == 'already_exists') %}
              This rule or a more global rule already exists in the {{ listType }}
            {% elif status[0] == 'invalid_url' %}
              Invalid URL!
            {% endif %}
            </div>
        </div>
        <!-- add items -->
        <div class="well well-small">
          <form id="addItem" method="get" class="nav form-search" onsubmit="addItem(); return false;">
            <strong>Add an item to the {{ listType }}</strong> <br />
            <input id="id" class="listInput" type='text' placeholder="full or partial CPE" pattern="cpe:/[a-z0-9/ .:%_-~]+" /> <br />
            <textarea id="comments" class="listInput" rows="4" placeholder="comments, separated by enter" /></textarea> <br />
            <button>Add</button>
          </form>
        </div>
        <table class="table table-hover table-striped">
          <tbody>
            <tr class="warning">
              <td>Rule</td><td>Comments</td>
            </tr>
            {% for ruleID in rules %}
              <tr>
                <td> {{ ruleID['id'] }}</td>
                <td>
                  <ul>
                    {% for comment in ruleID['comments'] %}
                      <li> {{ comment }} </li>
                    {% endfor %}
                  </ul>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      <!-- end content -->
    </div>
  </div>
</div>
</body>
