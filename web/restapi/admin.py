from flask_restx import Namespace, Resource

from lib.DatabaseLayer import getWhitelist
from web.restapi.auth import message

api = Namespace("admin", description="Endpoints for admin", path="/admin/")


@api.route("/whitelist")
@api.response(400, "Error processing request", model=message)
@api.response(500, "Server error", model=message)
class WhitelistClass(Resource):
    def get(self):
        """
        List Whitelist

        Get a list of the currently available entries in the whitelist
        """
        return getWhitelist()
