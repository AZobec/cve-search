#!/usr/bin/env python3
# -*- coding: utf-8 -*-
#
# Objects for CVE-Search internal workings
#
# Software is free software released under the "Modified BSD license"
#

# Copyright (c) 2014-2016       Pieter-Jan Moreels - pieterjan.moreels@gmail.com

# imports
import lib.Toolkit as tk

#######
# CPE #
#######
class CPE:
  def __init__(self, id, title=None, references=[]):
    self.id         = tk.toStringFormattedCPE(id)
    self.id_2_2     = tk.toOldCPE(id)
    self.title      = title if title else tk.cpeTitle(self.id)
    self.references = references

  def dict(self):
    return {'id':         self.id,
            'cpe_2_2':    self.id_2_2,
            'title':      self.title,
            'references': self.references}

  @classmethod
  def fromDict(cls, data):
    return cls(data['id'], data['title'], data['references'])





