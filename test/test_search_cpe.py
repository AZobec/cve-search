import pytest

from test.runners.cli_test_runner import CLITestRunner


@pytest.fixture
def runner():
    return CLITestRunner()


def test_search_cpe(runner):

    result = runner.runcommand("bin/search_cpe.py -s wordpress")

    resultlist = result.stdout.split("\n")

    assert result.returncode == 0
    assert resultlist[0][41:] == '10Web Photo Gallery * for wordpress'


def test_search_cpe_json(runner):

    result = runner.runcommand("bin/search_cpe.py -s wordpress -o json")

    assert result.returncode == 0


def test_search_cpe_compact(runner):

    result = runner.runcommand("bin/search_cpe.py -s wordpress -o compact")

    assert result.returncode == 0


def test_search_cpe_csv(runner):

    result = runner.runcommand("bin/search_cpe.py -s wordpress -o csv")

    assert result.returncode == 0
